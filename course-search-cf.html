

<?php
//setup key variables
$responsibilities = get_field('civic_responsibility', 1718);
$domains = get_field('domains', 1718);
$semesters = get_field('semester_offered', 1718);

?>
<!-- Begin Search -->
<div class="liberal-search">
<form class="search_form">
   <input class="search_tabs search-expand" id="myInput-lions-search-grid" data-type="search" type="text" placeholder="Search.." onclick="expandSearch()">
   <img src="https://engineering.tcnj.edu/wp-content/uploads/sites/194/2021/02/headway-imported-image.png" id="clear-filter" alt="close"/>
</form>

<!-- Begin Filters -->
<div class="filters" style="margin-top:25px;margin-bottom:75px">
  
  <div class="ui-group">
    <h3 style="font-size:21px;line-height:30px;font-family:'Bitter',sans-serif;color:#3e3e3e;font-weight:400;margin-top:0px;margin-bottom:5px;text-transform:none;text-align:left;margin-left:0;">Domain</h3>
    <select class="button-group js-radio-button-group" value-group="color">
      <option class="button is-checked" value="">none</option>
      <!--       <input checked class="button is-checked" value="" type="checkbox" id="any" name="vehicle1" value="Bike">
<label for="any"> I have a bike</label><br> -->
<?php
  
foreach ((array) $domains as $domain) {	
  echo '<option class="button" value=".' . str_replace(array(' ', ',', '&','.'), '-', strtolower($domain)) . '">' . $domain . '</option>';
  }
?>


    </select>
  </div>

  <div class="ui-group">
    <h3 style="font-size:21px;line-height:30px;font-family:'Bitter',sans-serif;color:#3e3e3e;font-weight:400;margin-top:0px;margin-bottom:5px;text-transform:none;text-align:left;margin-left:0;">Civic Responsibility</h3>
    <select class="button-group js-radio-button-group" value-group="size">
      <option class="button is-checked" value="">none</option>
      <?php
  
        foreach ((array) $responsibilities as $responsibility) {	
          echo '<option class="button" value=".' . str_replace(array(' ', ',', '&','.'), '-', strtolower($responsibility)) . '">' . $responsibility . '</option>';
          }
        ?>
      
      

    </select>
  </div>

  <div class="ui-group">
    <h3 style="font-size:21px;line-height:30px;font-family:'Bitter',sans-serif;color:#3e3e3e;font-weight:400;margin-top:0px;margin-bottom:5px;text-transform:none;text-align:left;margin-left:0;">Semester </h3>
    <select class="button-group js-radio-button-group" value-group="shape">
      <option class="button is-checked" value="">any</option>
      <?php
  
      foreach ((array) $semesters as $semester) {	
        echo '<option class="button" value=".' . str_replace(array(' ', ',', '&','.'), '-', strtolower($semester)) . '">' . $semester . '</option>';
        }
      ?>
    </select>
  </div>
</div><!-- End Filters -->

<!-- Begin Grid -->
<div class="grid">
<!-- Begin MAT 255 -->


<?php 
query_posts(array( 
    'post_type' => 'course_post',
    'orderby' => array( 'meta_value' => 'ASC', 'title' => 'ASC' ),

'order' => 'ASC',
//exclude the post below from showing up in query
//'post__not_in' => array(1718), 
'posts_per_page' => -1, 
) );  
?>


<!-- Below loops through civic -->


<?php while (have_posts()) : the_post(); 

$postResponsibilities = get_field('civic_responsibility'); 
$postDomains = get_field('domains');
$postSemesters = get_field('semester_offered');
?>

<p></p>
  <div class="color-shape <?php 

  if($postResponsibilities) {
  foreach ((array) $postResponsibilities as $postResponsibility) {	
  echo str_replace(array(' ', '.'), '-', strtolower($postResponsibility)) . ' ';
  }
  
  
   };
  
   if($postDomains) {
    foreach ((array) $postDomains as $postDomain) {	
    echo str_replace(array(' ', '.'), '-', strtolower($postDomain)) . ' ';
    }
    
    
     };
  
     if($postSemesters) {
      foreach ((array) $postSemesters as $postSemester) {	
      echo str_replace(array(' ', '.'), '-', strtolower($postSemester)) . ' ';
      }
      
      
       };
  ?>">

    <h3 style="font-size:23px;line-height:35px;font-family:'Domine',serif;color:#3e3e3e;font-weight:700;margin-top:0px;margin-bottom:25px;text-transform:none;text-align:left;"><?php echo get_the_title( $post_id ); ?></h3>
      <!-- Begin Left Column -->
    <div>
      <div class="sub">
          <p><strong>Scheduled: </strong><?php if($postSemesters) {
            foreach ((array) $postSemesters as $postSemester) {	
            echo $postSemester . ', ';
            }
            
            
             };
        ?></p>
          <p><strong>Enrollment Requirement: </strong><?php echo get_field('enrollment_requirements'); ?></p>
         <p><strong>Units: </strong><?php echo get_field('units'); ?></p> 
        </div>
      <p style="font-size:20px;line-height:30px;" class="course-description"><?php echo get_field('description'); ?></p><p class="read-full">Read the full course description</p>
      </div><!-- End Left Column -->
    <!-- Begin Right Column -->
    <div>
      <div class="sub">
       <p><strong>Domain:</strong> 
        <?php
        if($postDomains) {
          foreach ((array) $postDomains as $postDomain) {	
          echo $postDomain . ', ';
          }
          
          
           };
        
        ?>
      </p>
      <p><strong>Civic Responsibility: </strong><?php 

        if($postResponsibilities) {
        foreach ((array) $postResponsibilities as $postResponsibility) {	
        echo $postResponsibility . ', ';
        }
        
        
         };
        
        
        ?></p>
      <div style="border-top:1px dashed #767676; width:85%;margin:25px 10px;padding:20px 0">
      <p style="line-height:26px"><i class="fas fa-info-circle"></i> <em>A single course can satisfy <strong>only one</strong> domain but <strong>up to two</strong> civic responsibilities.</em></p> 
      <p style="line-height:26px"><i class="fas fa-info-circle"></i> <em>If two domains or three civic responsibilities are listed, contact <a target="_blank" href="https://recreg.tcnj.edu/">Records and Registration</a> once you have enrolled in the course to indicate which domain or civic responsibilities you wish to have counted.</em></p></div>
    </div>
    </div><!-- End Right Column -->
  </div><!-- End MAT 255 -->
  <?php endwhile;?>
</div><!-- Grid -->
</div><!-- End Search -->

<div class="modal-outer-docuseries">
  <div class="modal-inner-docuseries">
  </div>
</div>

<script>

function closeModal() {
  modalOuter.classList.remove('open');

}
const llClass = document.querySelectorAll('.color-shape');
  const cardButtons = document.querySelectorAll('.course-description');
  const readButton = document.querySelectorAll('.read-full');
  const modalOuter = document.querySelector('.modal-outer-docuseries');
const modalInner = document.querySelector('.modal-inner-docuseries');
const buttonSelect = document.querySelector('.modal-inner-docuseries .close-module-button');
  function handleCardButtonClick(event) {
    // const card = button.closest('.facility-item-container') || button.previousElementSibling;
  
    const button = event.currentTarget;
  const card = button.closest('.color-shape'); 

  // Grab the image src
  // const imgSrc = card.querySelector("img").src;
  const desc = card.querySelector('.course-description').textContent;
  const name = card.querySelector('h3').textContent;

  // populate the modal with the new info
  modalInner.innerHTML = `<div class="intro-content">
    <p class="inner-theme">${name}</p>
    <hr/>

<div class="bio">
   <p>${desc}</p>
</div>


</div>

<div class="close-module-button" id="close-button" ></div>
`;
  // show the modal
  modalOuter.classList.add('open');


    // button.classList.toggle('expanded-description');
  }
  
  
  cardButtons.forEach((button) => button.addEventListener('click', handleCardButtonClick));
  readButton.forEach((button) => button.addEventListener('click', handleCardButtonClick));

  modalOuter.addEventListener('click', (event) => {
  const isOutside = !event.target.closest('.modal-inner-docuseries');
  if (isOutside) {
    closeModal();
  }
});
modalOuter.addEventListener('click', (event) => {
  const buttonClose = event.target.closest('.close-module-button');
  if (buttonClose) {
    closeModal();
  }
});
window.addEventListener('keydown', (event) => {
  console.log(event);
  if (event.key === 'Escape') {
    closeModal();
  }
});

//   jQuery(document).ready(function ($) {
// var $grid = $('.grid').isotope({
//   itemSelector: '.color-shape'
// });
//   $('.course-description').on('click', function() {
//     $grid.isotope({ filter: '*' });
  
// });
// });


  </script>
  
  <style>
   /* .course-description{font-size: 20px;
  line-height: 30px;
  max-height: 300px;
  overflow: hidden;transition: max-height 1s ease-in-out;}  */
  .course-description{    transition: max-height 1s ease-in-out;
    display: -webkit-box;
    overflow: hidden;
    -webkit-line-clamp: 10;
    -webkit-box-orient: vertical;
    cursor: pointer;
}
.read-full{cursor: pointer;color: #4a85b9;}
.read-full:hover{text-decoration: underline;}

  .course-description::after{
    content:'...<br/>Read full course description.';
  }
  
  /* 
  .course-description.expanded-description{  transition: max-height 1s ease-in-out;
    overflow: hidden;
    max-height: 1000px;} */
    .modal-outer-docuseries {
  display: -ms-grid;
  display: grid;
  background: rgba(0, 0, 0, 0.7);
  position: fixed;
  height: 100vh;
  width: 100vw;
  top: 0;
  left: 0;
  -webkit-box-pack: center;
  -ms-flex-pack: center;
  justify-content: center;
  -webkit-box-align: center;
  -ms-flex-align: center;
  align-items: center;
  /* Hide this modal until we need it */
  opacity: 0;
  pointer-events: none;
  -webkit-transition: opacity 0.2s;
  transition: opacity 0.2s;
}

.modal-outer-docuseries img {
  width: 100%;
}

.modal-outer-docuseries.open {
  opacity: 1;
  pointer-events: all;
  z-index: 99999;
}

.modal-inner-docuseries {
  max-width: 1000px;
  min-width: 200px;
  padding: 2rem;
  border-radius: 0;
  min-height: 700px;
  background: white;
  -webkit-transform: translateY(-200%);
  transform: translateY(-200%);
  -webkit-transition: -webkit-transform .2s;
  transition: -webkit-transform .2s;
  transition: transform .2s;
  transition: transform .2s, -webkit-transform .2s;
  margin: 20px 20px;
  max-height: 500px;
  overflow: auto;
}

.modal-inner-docuseries .bio {
  text-align: left;
  line-height: 1.5rem;
  font-size: 1rem;
}

.modal-inner-docuseries p {
  margin-bottom: 10px;
  font-size: .85rem;
}

.modal-inner-docuseries h3 {
  text-align: left;
  font-size: 1.5rem;
  margin-bottom: 20px;
}

.modal-outer-docuseries.open .modal-inner-docuseries {
  -webkit-transform: translateY(0);
  transform: translateY(0);
}

.close-module-button {
  background: url("https://education.tcnj.edu/wp-content/uploads/sites/206/2020/08/grad-ed-site-home-popup-X-FINAL-081220-30px.png");
  height: 20px;
  width: 20px;
  position: absolute;
  top: 40px;
  right: 35px;
  background-size: 100%;
  cursor: pointer;
}

.modal-inner-docuseries .intro-content {
  width: 100%;
  margin-top: 0px;
}

.modal-inner-docuseries .inner-theme {
  font-family: 'Bitter',
 sans-serif !important;
  color: #2E2E2E;
  font-weight: 400;
  font-size: 20px !important;
}

.modal-inner-docuseries .inner-theme span {
  font-family: 'Passion One', 'Open Sans';
  font-weight: 400;
  font-size: 21px;
}

.modal-inner-docuseries hr {
  margin: 14px 0 26px !important;
}

.modal-inner-docuseries h3 {
  font-family: 'Special Elite', 'Open Sans';
  font-size: 27px;
  margin-top: 21px;
  margin-bottom: 17px;
}

.modal-inner-docuseries .bio p {
  font-family: 'Open Sans';
  font-size: 17px;
  line-height: 25px;
  color: #000;
  text-align: left;
  margin-bottom: 50px;
  color: #3e3e3e !important;
  font-family: 'Domine',
 serif !important;
  font-size: 18px !important;
  line-height: 40px !important;
  margin-top: 20px !important;
}


  </style>